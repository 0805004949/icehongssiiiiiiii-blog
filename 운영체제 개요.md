
---
title: 운영체제 개요
date: 2023-05-05 17:04
lastMod: 2023-05-09 00:16
tags: ["2023-k8s-bootcamp","book","OS","CS","kr", "blog-published"] 
categories: ["TIL"] # <!--"progress-diary", "posts"  , "TIL"하나만 선택해서보셈 -->
slug: "" # <!--영어 slug만 가능 url에서 보일 수 있음-->
aliases: "" # <!--뭔지몰라-->
keywords: [""] # <!--뭔지몰라-->
series: "" # <!--뭔지몰라-->
description: "" # <!--포스트에대한설명 -->
---

# 3장 운영체제

> [!hint] Keyword 메모리, 프로레슷, 스레드, CPU

## 🐵 1. 운영체제와 컴퓨터

운영체제(OS)

펌웨어

사용자가 컴퓨터 쉽게 다루게 해주는 인터페이스. 시스템자원 효율적으로 분배가능

OS와 비슷하지만 SW 추가설치할 수 없음

### 1.1 운영체제 역할과 구조

### 1.1.1 운영체제 역할

1.  CPU 스케줄링과 프로세스 관리
2.  메모리관리
3.  디스크 파일관리
4.  I/O 디바이스 관리

### 1.1.2 운영체제구조

**운영체제구조**

---

유저프로그램

---

**GUI**

---

**시스템콜**

---

**커널**

---

**드라이버**

---

하드웨어

---

> [!abstract] 유저 프로그램이 상단에 있고 그 아래에 있는 GUI, 시스템콜, 커널, 드라이버 4가지가 운영체제 지칭 GUI 없고 CUI있는 리눅스 서버도 있음

-   시스템콜 : OS가 커널에 접근하기 위한 인터페이스. 유저 프로그램이 OS의 서비스를 받기 위해 커널 함수 호출 할 때 사용

> [!note] keyword 커널 : OS 핵심부분, 시스템콜 인터페이스 제공. 보안, 메모리, 프로세스, 파일시스템, I/O 디바이스,등 운영체제 중추역할
> 
> -   유저모드 : 유저 접근 영역 제한해 컴퓨터 자원 함부러 침범 못하게함
> -   커널모드 : 모든 컴퓨터 자원 접근 가능 모드

유저 프로그램 I/O 요청 발동 -> 올바른 I/O요청인지 확인후 유저모드가 시스템콜 통해 커널모드로 변환 돼 실행

예를 들면 유저모드에서 파일 안읽고 커널모드에서 파일 읽고 유저모드로 바꿔 유저 프로그램 로직 수행

![https://i.imgur.com/DO337hK.png](https://i.imgur.com/DO337hK.png)

출처 :

[](https://velog.io/@jsb12302/%EC%9A%B4%EC%98%81%EC%B2%B4%EC%A0%9C%EC%9D%98-%EC%97%AD%ED%95%A0%EA%B3%BC-%EA%B5%AC%EC%A1%B0)[https://velog.io/@jsb12302/운영체제의-역할과-구조](https://velog.io/@jsb12302/%EC%9A%B4%EC%98%81%EC%B2%B4%EC%A0%9C%EC%9D%98-%EC%97%AD%ED%95%A0%EA%B3%BC-%EA%B5%AC%EC%A1%B0)

프로세스, 메모리, 스레드가 운영체제로 요청 할 때 항상 시스템콜이라는 인터페이스 커널 거쳐 OS에게 전달

> [!note] keyword modebit : 시스테콜 작동시 modebit 참고해 유저모드와 커널모드로 구분. 이는 플래그 변수로 1,0 값가짐(0=커널모드)

### 1.2 컴퓨터 요소

### 1.2.1. CPU

> [!abstract] 제어장치, 레지스터, 산술논리 연산장치로 구성된 컴퓨터장치 인터럽트에 의해 단순히 메모리에 존재하는 명령어를 해석해서 실행하는 일꾼. 관리자 역할한느 OS의 커널이 프로그램 메모리에 올려 프로세스로 만들면 워커인 CPU가 이를 처리

-   제어장치 : 프로세스 조작 지시. I/O 장치 통신제어. 명령어 읽고 해석 데이터 처리 순서 결정
-   레지스터 : CPU내 매우빠른 임시기억장치. CPU 자체가 데이터 저장 못하기에 레지스터를 거쳐 데이터 전달
-   산술논리연산장치 : 두 숫자 산술 연산, 논리연산, 배타적 논리합, 논리곱등하는 디지털 회로

> 제어장치가 메모리에 계산 할 값 로드 & 레지스터에도 로드 -> 제어장치가 레지스터에 있는 값 계산하라고 논리연산장치 명령 -> 제어장치가 계산된 값 다시 레지스터에서 메모리로 계산 값 저장

-   인터럽트 : 어떤 신호 들어왔을 떄 CPU 잠시 정지시키는것말함.
    -   하드웨어 인터럽트 : I/O 디바이스 연결하거나등 디바이스에서 발생하는 인터럽트
    -   소프트웨어 인터럽트(=trap) : 프로세스 오류등으로 시스템콜 호출 할 때 발동

### 1.2.2. DMA

-   I/O디바이스가 메모리에 직접 전근할 수 있도록 하는 HW장치
-   CPU 부하막고 도와주는 보조일꾼
-   하나의 작업을 CPU와 DMA 컨트롤러가 동시에 하는 것 방지

### 1.2.3. 메모리

-   전자회로에서 데이터 상태, 명령어 기록하는 장치
-   보통RAM을 일컬어 메모리라고함
-   CPU는 계산, RAM은 기억

### 1.2.4. 타이머

-   몇초안에 작업이 끝나야한다는 것을 정하고 특정 프로그램에 시간 제한다는 역할

### 1.2.5. 디바이스 컨트롤러

-   컴퓨터와 연결된 IO디바이스 작은 CPU를 말하고 옆에 붙은 로컬 버퍼는 각 디바이스 데이터를 임시로 저장하기위한 작은 메모리

---

## 🐵 2. 메모리

### 2.1 메모리계층

-   CPU = 메모리에 올라와 있는 프로그램 명령어 실행

메모리계층

속도순위

용량순위

레지스터

1

4

캐시(L1,L2)

2

3

메모리(RAM)/주기억장치

3

2

저장장치(HDD,SDD)/보조기억장치

4

1

-   레지스터 : CPU안에 있는 작은메모리. 휘발성, 속도 가장빠르고 용량도작다
-   캐시 :L1, L2캐시 지칭. L3캐시도 있음
-   주기억장치 : RAM지칭. 램은 하드디스크로부터 일정 데이터 복사해 임시저장하고 필요시마다 CPU에 빠르게 전달하는 역할
-   보조기억장치 : HDD, SDD일컬음

계층 위로 올라갈 수록 가격은 비싸지는데 용량은 작아지고 속도는 빨라짐 게임실행하다 로딩중이라고 뜨는건 하드디스크나 인터넷에서 데이터 읽고 램으로 전송하는 과정이 아직 덜 끝났음 의미

> [!note] 캐싱 계층 메모리와 CPU 속도차이가 너무 크기에 중간 레지스터 계층을 둬서 속도차이 해결하고자함. 이렇게 속도차이 해결하기위해 계층 사이사이에 있는 계층을 캐시 계층이라고함. 캐시 메모리와 보조기억장치(HDD,SDD)사이에 있는 주기억장치를 보조기억장치의 캐싱계층이라할 수 있음

-   캐시 : 데이터 미리 복사해놓는 임시저장소이자 빠른 장치와 느린장치 속도차이에 따른 병목현상 줄이기 위한 메모리
-   캐시히트 : 캐시에서 원하는 데이터 찾았을 경우
-   캐시미스 : 해당 데이터가캐시에 없다면 주메모리로 가서 데이터 찾아오는것

```
캐시 지역성?

```

-   캐시매핑 : 캐시가 히트되기 위한 매핑 방법. CPU의 레지스터와 주메모리(RAM)간 데이터 주고 받을 때 기반으로 설명. 레지스터가 주메모리에 비해 작고 주메모리는 크기에 레지스터가 캐시계층으로써 역할 잘 하려면 어떻게 이 매핑하느냐가 중요
    -   직접매핑
    -   연관매핑
    -   집합연관매핑

```
웹브라우저캐시

```

### 2.2 메모리관리

2.2.1 가상메모리 2.2.2 스레싱 2.2.3 메모리할당 2.2.4 페이지교체 알고리즘

---

## 🐵 3. 프로세스와 스레드

-   프로세스 : 컴퓨터에서 실행되고 있는 프로그램 (=CPU 스케줄링 대상되는 task과 거의 비슷한 용어로 쓰임)
-   스레드 : 프로세스 내 작업 흐름

### 3.1 프로세스와 컴파일과정

-   프로세스 = 프로그램이 메모리 올라가 인스턴스화 된 것
    
    ![https://i.imgur.com/Mka4lLZ.jpg](https://i.imgur.com/Mka4lLZ.jpg)
    

![https://i.imgur.com/ZSendex.jpg](https://i.imgur.com/ZSendex.jpg)

-   프로그램 = 구글 크롬(chrome.exe) 과 같은 실행파일
-   프로세스 = 프로그램을 더블클릭해 구글 프로세스로 변환되는 것
-   프로그램 만드는 과정 : 언어마다 다르지만 컴파일언어 C 기반 프로그램같은 경우 컴파일러가 컴파일 고자ㅓㅇ통해 컴퓨터 이해할 수 있는 기계어로 번역해 실행할 수 있는 파일을 만들어 준다

### 3.1.1 프로그램 컴파일 과정

```
- 전처리  : 주석제거. 헤더파일 병합해 매크로 치환?
- 컴파일러
- 어셈블러
- 링커
- 정적라이브러리
- 동적라이브러리

```

### 3.2 프로세스 상태

> [!note] PCB(Process COntrol Block) OS에서 프로세스에 대한 메타데이터 저장한 데이터 = 프로세스 제어 블록 = 프로세스 생성시 OS는 해당 PCB 생성

-   생성상태 : 프로세스 생성된 상태. PCB 할당됨. fork(), exec()함수로 생성됨
-   대기상태 : 메모리 공간 충분시 메모리 할당 받고 아니면 아닌 상태로 대기 & CPU 스케줄러로 CPU 소유궈 ㄴ넘어오기 기다리는 상태
-   대기중단상태 : 메모리 부족으로 일시 중단된 상태
-   실행상태 : CPU 소유권과 메모리 할당 받고 명령 수행중인 상태(=CPU burst, running)
-   중단상태 : 어떤 이벤트 이후 기다리며 프로세스 차단된 상태(프린트 인쇄 버튼 눌렀을때 프로세스가 잠시 멈춘듯한 상태)
-   일시중단상태 : 대기중단과 비슷함. 중단된상태에서 프로세스 실행하려고 했지만 메모리 부족으로 일시중단됨
-   종료상태 : 메모리와 CPU 소유권을 모두 놓고가는 상태. 부모 프로세스가 자식 프로세스 강제 종료하는 것도 있음. 자식 프로세스에 할당된 자원 한계 넘거나 부모 프로세스가 종료되거나 사용자가 kill등으로 죽일 경우 발생

### 3.3 프로세스의 메모리 구조

![https://i.imgur.com/9A9O8Hq.png](https://i.imgur.com/9A9O8Hq.png)

출처 : [](https://www.includehelp.com/operating-systems/memory-layout-of-a-process.aspx)[https://www.includehelp.com/operating-systems/memory-layout-of-a-process.aspx](https://www.includehelp.com/operating-systems/memory-layout-of-a-process.aspx)

### 3.3.1 스택과 힙

-   동적할당
-   동적할당 = 런타임단계에서 메모리 할당 받는 것
-   스택 = 지역변수, 매개변수, 실행함수 부르거나 주는 메모리 영역. 함수 호출시 환경정보 등 특정벙보가 스택에 계속 저장됨
-   힙 = 동적할당 되는 변수. malloc(), free() 함수 통해 관리할 수 있고 동적으로 관리되는 자료구조 경우 사용

### 3.3.2 데이터 영역과 코드(텍스트) 영역

-   정적할당
-   정적할당 = 컴파일 단계에서 메모리 할당
-   데이터 영역
    -   BSS segment : 전역변수 or static, const 선언 & 0으로 초기화 또는 초기화 되어있지 않은 변수들이 이 영역에 할당됨
    -   data segment : 전역변수 or static, const 선언 & 0이 아닌 값으로 초기화된 변수가 이 영역에 할당됨
-   코드 텍스트 영역 (code/text segment) : 프로그램 코드

### 3.4 PCB

-   프로그램 실행시 프로세스 생성 -> 프로세스 주소값들이 스택, 힙등 구조로 메로리 할당됨
-   프로세스 메타데이터가 PCB 저장되어 관리

### 3.4.1 PCB 구조

-   프로세스 스케줄링 상태
-   프로세스 ID
-   프로세스 권한
-   CPU 레지스터
-   CPU 슼줄링 정보
-   계정정보
-   IO 상태정보

### 3.4.2 컨텍스트 스위칭

-   PCB 교환과정
-   한 프로세스 할당 시간 끝나거나 인터럽트에 의해 발생
-   컴퓨터가 많은 프로그램 동시에 실행한 것 처럼 보이지만 어떤 시점에 실행되고 있는 프로세스는 단 한개
-   많은 프로세스가 동시에 구동되어 있는 것 같지만 다른 프로세스와 컨텍스트 스위칭이 빠르게 일어남
-   멀티코어 CPU이기에 한시점에 한개 프로그램은 틀리지만 보통 싱글코어 기준설명

출처 : [](https://velog.io/@haero_kim/PCB-%EC%99%80-Context-Switching-%EC%95%8C%EC%95%84%EB%B3%B4%EA%B8%B0)[https://velog.io/@haero_kim/PCB-와-Context-Switching-알아보기](https://velog.io/@haero_kim/PCB-%EC%99%80-Context-Switching-%EC%95%8C%EC%95%84%EB%B3%B4%EA%B8%B0)

![https://i.imgur.com/65YSFvj.png](https://i.imgur.com/65YSFvj.png)

-   P0프로세스 실행하다가 멈추고 프로세스 P0 PCB를 저장하고 다시 프로세스 P1로드 해서 실행 그러다가 P1 PCB 저장하고 다시 프로세스 P0 프로세스 로드해서 실행
-   컨텍스트 스위칭일어날 떄 idle time 발생
-   컨텍스트 스위칭에서 드는 비용 = 캐시미스

### 3.5 멀티프로세싱

-   멀티프로세싱 = 여러개으 프로세스 = 멀티 프로세스를 통해 두가지 일 수-행하는 것
-   하나이상의 일 병렬처리가능

### 3.4.1 웹브라우저

웹브라우저도 멀티 프로세스 구조 갖고 있음

-   브라우저 프로세스 : 주소, 표시줄, 북마크등 담당하며 네트워크 요청이나 파일 접근 같은 권한담당
-   렌더러 프로세스 : 웹사이트가 보이는 부분 모든 것 제어
-   플러그인 프로세스 : 웹 사이트에서 사용하는 플러그인 제어
-   GPU 프로세스 : GPU이용해 화면 그리는 부분 제어

### 3.4.2 IPC

-   멀티프로세스는 IPC가능
-   IPC = 프로세스끼리 데이터 주고 받으며 공유 데이터 관리
-   클라이언트,서버 -> 클라이언트가 데이터 요청하고 서버가 요청에 응하는 것도 IPC의 예
-   IPC 종류 : 공유 메모리, 파일, 소켓, 익명 파이프, 명명 파이프, 메세지 큐등 메모리가 완전히 공유되는 스레드보다는 속도가 떨어짐

### 3.6 스레드와 멀티스레딩

### 3.6.1 스레드

-   프로세스 실행 가장 작은 단위
-   프로세스는 여러개의 스레드 가질 수 있음
-   프로세스는 코드, 데이터, 스택, 힙을 각각 생성하지만 스레드는 코드, 데이터, 힙은 스레드끼리 공유한다

### 3.6.2 멀티스레딩

-   멀티스레딩 = ㅅ프로세스 내 작업 여러개의 스레드, 멀티스레드로 처리
-   스레드끼리 자원공유해 ㅎ호율 높다
-   웹 요청 처리시 새 프로세스 생성하는 대신 스레드 사용하는 웹서드의 경우 적은 리소스 소비하고 한 스레드가 중단 되어도 다른 스레드는 실행 상태일 수도 있기에 중단되지 않으면 빠른 처리 가능
-   동시성(=독립적인 작업을 나누고 동시에 실행되는 것처럼 보여주는것)
-   하지만 한 스레드 문제 생기면 자원공유하는 다른 스레드에 영향끼치기에 스레드로 이루어진 프로세스에 문제생길수도

### 3.7 공유자원과 임계영역

### 3.7.1 공유자원

-   시스템안에서 각 프로세스나 스레드가 함꼐 접근할 수 있는 기기나 파일, 데이터 등 변수
-   공유 자원을 두개 이사의 프로세스가 동시에 읽거나 쓰는 상황 = race condition = 동시에 접근시 결괏값에 영향을 줄 수 있는 상태
-   프로세스가 꼬여 정상 결괏값이 나오지 않을 수도 있음

### 3.7.2 임계영역

-   critical section
-   둘 이상의 프로세스나 스레드가 공유 자원 접근시 순서등의 이유로 결과가 달라지는 것
-   임계영역 해결방안
    -   뮤텍스
    -   세마포어
    -   모니터

> [!note] keyword 상호배제, 한정대기, 융통성

### 3.8 교착상태(daedlock)

-   두 개 이상의 프로세스들이 서로가 가진자원 기다리며 중단된 상태
-   원인
    -   상호배제
    -   점유대기
    -   비선점
    -   환형대기
-   해결방안
    1.  자원할당시 조건 성립되지 않게 서게
    2.  교착상태 가능성 없을 때만 자원 할당 & 프로세스당 요청 자원 최대치 통해 자원하당 가능 여부 파악하는 은행원 알고리즘 사용
    3.  교착 상태 발생시 사이클 있는지 확인해보고 이에 관련된 프로세스 하나씩 지움
    4.  교착상태는 드물게 일어나고 이 처리비용이 더 비싸기에 사용자가 종료한다

---

## 🐵 4. CPU 스케줄링 알고리즘

-   프로그램이 실행될 떄 CPU 스케줄링 알고리즘이 어떤 프로그램에 CPU 소유권을 줄 것인지 결정
-   이 알고리즘은 CPU 이용률은 높게, 주어진 시간에 많은 일 하게, 준비큐에 있는 프로세스는 적게, 응답시간은 짧게 설정하는 것이 목표

### 4.1 비선점형 방식

non-preemmptive는 프로세스가 스스로 CPU 포기하는 방식. 강제로 프로세스 중지하지 않고 컨텍스트 스위칭 부하가 적음

-   FCFS
-   SJF
-   우선순위

### 4.2 선점형 방식

preemptive 는 현대 OS가 쓰는 방식으로 지금 사용하고 있는 프로세스를 알고리즘에 의해 중단시키고 강제로 다른 프로세스에 CP 소유권 할당하는 방식

-   라운드로빈
-   SRF
-   다단계 큐


## 📑 Ref
- 책-면접을위한CS전공지식